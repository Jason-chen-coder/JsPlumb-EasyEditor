(function(e){function t(t){for(var o,s,l=t[0],r=t[1],c=t[2],u=0,p=[];u<l.length;u++)s=l[u],Object.prototype.hasOwnProperty.call(n,s)&&n[s]&&p.push(n[s][0]),n[s]=0;for(o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o]);d&&d(t);while(p.length)p.shift()();return a.push.apply(a,c||[]),i()}function i(){for(var e,t=0;t<a.length;t++){for(var i=a[t],o=!0,l=1;l<i.length;l++){var r=i[l];0!==n[r]&&(o=!1)}o&&(a.splice(t--,1),e=s(s.s=i[0]))}return e}var o={},n={app:0},a=[];function s(t){if(o[t])return o[t].exports;var i=o[t]={i:t,l:!1,exports:{}};return e[t].call(i.exports,i,i.exports,s),i.l=!0,i.exports}s.m=e,s.c=o,s.d=function(e,t,i){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(s.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)s.d(i,o,function(t){return e[t]}.bind(null,o));return i},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="/";var l=window["webpackJsonp"]=window["webpackJsonp"]||[],r=l.push.bind(l);l.push=t,l=l.slice();for(var c=0;c<l.length;c++)t(l[c]);var d=r;a.push([0,"chunk-vendors"]),i()})({0:function(e,t,i){e.exports=i("56d7")},"0b1e":function(e,t,i){},"29a0":function(e,t,i){},"2a22":function(e,t,i){},"4bf4":function(e,t,i){"use strict";i("0b1e")},"56d7":function(e,t,i){"use strict";i.r(t);var o=i("2b0e"),n=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"app"}},[t("flow-editor")],1)},a=[],s=function(){var e=this,t=e._self._c;return e.flowVisible?t("div",{staticStyle:{height:"calc(100vh)","over-flow":"hidden"},attrs:{id:"editor"}},[t("el-row",[t("el-col",{attrs:{span:24}},[t("div",{staticClass:"ee-tooltar"},[t("el-link",{attrs:{type:"primary",underline:!1}},[t("h2",[e._v("Easy Editor")])]),t("span",{staticClass:"tooltar-center"},[t("el-link",{attrs:{type:"primary",underline:!1}},[e._v(e._s(e.data.name))]),t("el-divider",{attrs:{direction:"vertical"}}),t("el-popover",{staticStyle:{"text-align":"center"},attrs:{placement:"bottom",width:"150",trigger:"hover"}},[t("div",{staticStyle:{"text-align":"center"}},[e._v("生成图片")]),t("el-button",{attrs:{slot:"reference",type:"text",icon:"el-icon-picture-outline",size:"large"},on:{click:e.saveAsImage},slot:"reference"})],1),t("el-divider",{attrs:{direction:"vertical"}}),t("el-popover",{staticStyle:{"text-align":"center"},attrs:{placement:"bottom",trigger:"hover",width:"150"}},[t("div",{staticStyle:{"text-align":"center"}},[e._v("删除节点")]),t("el-button",{attrs:{slot:"reference",type:"text",icon:"el-icon-delete",size:"large",disabled:!this.activeElement.type},on:{click:e.deleteElement},slot:"reference"})],1),t("el-divider",{attrs:{direction:"vertical"}}),t("el-popover",{staticStyle:{"text-align":"center"},attrs:{placement:"bottom",trigger:"hover",width:"150"}},[t("div",{staticStyle:{"text-align":"center"}},[e._v(e._s(e.isShowGrid?"隐藏网格线":"显示网格线"))]),t("el-button",{staticStyle:{"vertical-align":"middle"},attrs:{slot:"reference",type:"text",icon:(e.isShowGrid?"icon-dituleiwanggequ-copy ":"icon-fangxingweixuanzhong-copy ")+"iconfont",size:"large"},on:{click:function(t){e.isShowGrid=!e.isShowGrid}},slot:"reference"})],1),t("el-divider",{attrs:{direction:"vertical"}}),t("el-popover",{staticStyle:{"text-align":"center"},attrs:{placement:"bottom",trigger:"hover",width:"150"}},[t("div",{staticStyle:{"text-align":"center"}},[e._v("下载数据")]),t("el-button",{attrs:{slot:"reference",type:"text",icon:"el-icon-download",size:"large"},on:{click:e.downloadData},slot:"reference"})],1),t("el-divider",{attrs:{direction:"vertical"}}),t("el-popover",{staticStyle:{"text-align":"center"},attrs:{placement:"bottom",trigger:"hover",width:"150"}},[t("div",{staticStyle:{"text-align":"center"}},[e._v("上传数据")]),t("el-button",{attrs:{slot:"reference",type:"text",icon:"el-icon-upload2",size:"large"},on:{click:function(t){e.uploadDataVisible=!0}},slot:"reference"})],1)],1),t("div",{staticStyle:{float:"right","margin-right":"5px"}},[t("el-button",{attrs:{plain:"",round:"",icon:"el-icon-document",size:"mini"},on:{click:e.dataInfo}},[e._v("流程图数据")]),t("el-button",{attrs:{plain:"",round:"",icon:"el-icon-refresh",size:"mini"},on:{click:e.dataReloadA}},[e._v("切换流程A")]),t("el-button",{attrs:{plain:"",round:"",icon:"el-icon-refresh",size:"mini"},on:{click:e.dataReloadB}},[e._v("切换流程B")]),t("el-button",{attrs:{plain:"",round:"",icon:"el-icon-refresh",size:"mini"},on:{click:e.dataReloadC}},[e._v("切换流程C")]),t("el-button",{attrs:{plain:"",round:"",icon:"el-icon-refresh",size:"mini"},on:{click:e.dataReloadD}},[e._v("切换流程D")])],1)],1)])],1),t("div",{staticStyle:{display:"flex",height:"calc(100% - 47px)"}},[t("div",{staticStyle:{width:"230px","border-right":"1px solid #dce3e8"}},[t("node-menu",{ref:"nodeMenu",on:{addNode:e.addNode}})],1),t("div",{staticClass:"zoom-tool",on:{mousedown:function(e){e.stopPropagation()}}},[t("i",{staticClass:"el-icon-plus enlarged-btn"}),t("el-slider",{attrs:{step:.001,max:1.3,min:.7,vertical:"",height:"90px"},on:{dblclick:function(t){e.scaleValue=1},input:e.startScale},model:{value:e.scaleValue,callback:function(t){e.scaleValue=t},expression:"scaleValue"}}),t("i",{staticClass:"el-icon-minus shrink-btn"})],1),t("div",{directives:[{name:"flowDrag",rawName:"v-flowDrag"}],ref:"centerContainer",staticClass:"center-container",class:{"background-grid":e.isShowGrid},attrs:{id:"center-container"}},[t("div",{ref:"eeContainer",staticClass:"container",attrs:{id:"eeContainer"}},[t("div",{ref:"allnodes",staticClass:"all-nodes"},[e._l(e.data.nodeList,(function(i){return[t("flow-node",{key:i.id,attrs:{id:i.id,node:i,activeElement:e.activeElement},on:{changeNodeSite:e.changeNodeSite,nodeRightMenu:e.nodeRightMenu,clickNode:e.clickNode}})]}))],2)])]),t("div",{staticClass:"node-detail",class:{"node-form-active":e.isNodeFormActive}},[t("flow-node-form",{ref:"nodeForm",on:{repaintEverything:e.repaintEverything,changeNodeForm:e.changeNodeForm,setLineLabel:e.setLineLabel,changeNodeSite:e.changeNodeSite}})],1)]),e.flowInfoVisible?t("flow-info",{ref:"flowInfo",attrs:{data:e.data}}):e._e(),e.nodeDetailVisible?t("node-detail",{attrs:{currentNode:e.currentNode}}):e._e(),e.uploadDataVisible?t("upload-data",{on:{uploadPaintFlow:e.uploadPaintFlow}}):e._e(),e.imageLoadVisible?t("image-load",{ref:"imageLoad",attrs:{imgUrl:e.imgUrl,isShowGrid:e.isShowGrid}}):e._e()],1):e._e()},l=[],r=i("e193"),c=i("70b0"),d=i.n(c),u=function(){var e=this,t=e._self._c;return t("div",{ref:"node",class:e.nodeContainerClass,style:e.nodeContainerStyle,on:{click:e.clickNode,mouseup:e.changeNodeSite}},[t("div",{staticClass:"ee-node-left"}),t("div",{staticClass:"ee-node-left-ico flow-node-drag"},[t("i",{class:e.nodeIcoClass})]),t("div",{staticClass:"ee-node-text",attrs:{"show-overflow-tooltip":!0}},[e._v(e._s(e.node.name))]),t("div",{staticClass:"ee-node-right-ico"},[t("i",{directives:[{name:"show",rawName:"v-show",value:"success"===e.node.state,expression:"node.state === 'success'"}],staticClass:"el-icon-circle-check el-node-state-success"}),t("i",{directives:[{name:"show",rawName:"v-show",value:"error"===e.node.state,expression:"node.state === 'error'"}],staticClass:"el-icon-circle-close el-node-state-error"}),t("i",{directives:[{name:"show",rawName:"v-show",value:"warning"===e.node.state,expression:"node.state === 'warning'"}],staticClass:"el-icon-warning-outline el-node-state-warning"}),t("i",{directives:[{name:"show",rawName:"v-show",value:"running"===e.node.state,expression:"node.state === 'running'"}],staticClass:"el-icon-loading el-node-state-running"})])])},p=[],h={props:{node:Object,activeElement:Object},data(){return{}},computed:{nodeContainerClass(){return{"ee-node-container":!0,"ee-node-active":"node"==this.activeElement.type&&this.activeElement.nodeId===this.node.id}},nodeContainerStyle(){return{top:this.node.top,left:this.node.left}},nodeIcoClass(){var e={};return e[this.node.ico]=!0,e["flow-node-drag"]=!0,e}},methods:{clickNode(){this.$emit("clickNode",this.node.id),this.$parent.currentNode=this.node},changeNodeSite(){this.node.left==this.$refs.node.style.left&&this.node.top==this.$refs.node.style.top||this.$emit("changeNodeSite",{nodeId:this.node.id,left:this.$refs.node.style.left,top:this.$refs.node.style.top})}}},m=h,f=i("2877"),g=Object(f["a"])(m,u,p,!1,null,null,null),b=g.exports,v=function(){var e=this,t=e._self._c;return t("div",{ref:"tool",staticClass:"flow-menu"},[t("el-menu",{staticClass:"el-menu-vertical-demo",attrs:{"default-openeds":["1","2"]},on:{open:e.handleOpen,close:e.handleClose}},e._l(e.menuList,(function(i){return t("el-submenu",{key:i.id,attrs:{index:i.id}},[t("template",{slot:"title"},[t("i",{staticClass:"el-icon-s-help"}),t("span",[e._v(e._s(i.name))])]),t("el-menu-item-group",[t("draggable",{attrs:{options:e.draggableOptions},on:{end:e.end,start:e.move},model:{value:i.children,callback:function(t){e.$set(i,"children",t)},expression:"menu.children"}},e._l(i.children,(function(i){return t("el-menu-item",{key:i.id,attrs:{index:i.level,type:i.type}},[t("i",{class:i.ico,staticStyle:{color:"#1879ff"}}),e._v(" "+e._s(i.name)+" ")])})),1)],1)],2)})),1)],1)},y=[],w=i("b76a"),x=i.n(w),C={left:-1,top:-1},k={data(){return{activeNames:"1",draggableOptions:{preventOnFilter:!1,sort:!1,disabled:!1,ghostClass:"tt",chosenClass:"choosen",forceFallback:!0,fallbackClass:"flow-node-draggable"},defaultOpeneds:["1","2"],menuList:[{id:"1",type:"group",name:"接口节点",ico:"el-icon-video-play",children:[{id:"11",level:"1-1",type:"timer",name:"数据接入",ico:"el-icon-time",state:"success",style:{backgroundColor:"red"}},{id:"12",level:"1-2",type:"task1",name:"接口调用",ico:"el-icon-odometer",state:"success",style:{}},{id:"13",level:"1-3",type:"task2",name:"接口调试",ico:"el-icon-c-scale-to-original",state:"success",style:{}},{id:"14",level:"1-4",type:"timer2",name:"接口配置",ico:"el-icon-files",state:"success",style:{}}]},{id:"2",type:"group",name:"工具节点",ico:"el-icon-video-pause",children:[{id:"21",level:"2-1",type:"end",name:"流程结束",ico:"el-icon-caret-right",state:"success",style:{}},{id:"22",level:"2-2",type:"over",name:"数据重置",ico:"el-icon-shopping-cart-full",state:"success",style:{}},{id:"23",level:"2-3",type:"clean",name:"数据清理",ico:"el-icon-takeaway-box",state:"success",style:{}},{id:"24",level:"2-4",type:"middle",name:"中间件",ico:"el-icon-mobile",state:"success",style:{}},{id:"25",level:"2-5",type:"system",name:"系统配置",ico:"el-icon-coordinate",state:"success",style:{}}]}],nodeMenu:{}}},components:{draggable:x.a},created(){this.isFirefox()&&(document.body.ondrop=function(e){C.left=e.layerX,C.top=e.clientY-50,e.preventDefault(),e.stopPropagation()})},methods:{handleOpen(e,t){console.log(e,t)},handleClose(e,t){console.log(e,t)},getMenuByType(e){for(let t=0;t<this.menuList.length;t++){let i=this.menuList[t].children;for(let t=0;t<i.length;t++)if(i[t].type===e)return i[t]}},move(e){var t=e.item.attributes.type.nodeValue;this.nodeMenu=this.getMenuByType(t),console.log(this.nodeMenu)},end(e){this.$emit("addNode",e,this.nodeMenu,C)},isFirefox(){var e=navigator.userAgent;return e.indexOf("Firefox")>-1}}},D=k,L=(i("b660"),Object(f["a"])(D,v,y,!1,null,null,null)),S=L.exports,_=function(){var e=this,t=e._self._c;return t("el-dialog",{attrs:{title:"流程数据信息",visible:e.dialogVisible,width:"70%"},on:{"update:visible":function(t){e.dialogVisible=t}}},[t("json-viewer",{staticClass:"code",attrs:{value:e.data,"expand-depth":5,copyable:"",boxed:"",sort:""}})],1)},j=[],N=i("349e"),V=i.n(N),F=i("651e"),$=i.n(F),B={props:{data:Object},mounted(){console.log(this.data)},data(){return{dialogVisible:!1,flowJsonData:{}}},components:{JsonViewer:V.a},methods:{init(){this.dialogVisible=!0},jsonToYaml(e){return $.a.safeDump(e)},yamlToJson(e){return $.a.safeLoad(e)}}},E=B,I=Object(f["a"])(E,_,j,!1,null,null,null),O=I.exports,P=function(){var e=this,t=e._self._c;return t("el-dialog",{attrs:{title:e.currentNodeDetail.name,center:"",visible:e.nodeDialogVisible,width:"50%"},on:{closed:e.handleclose,"update:visible":function(t){e.nodeDialogVisible=t}}},[t("div",{ref:"detailContainer",staticClass:"nodeDetailInfo",attrs:{id:"detailContainer"}},[t("div",{attrs:{id:"detailbox"}},e._l(e.currentNodeDetail.nodeList,(function(i,o){return t("span",{key:o,ref:i.id,refInFor:!0,staticClass:"sub-node",style:{left:i.left,top:i.top},attrs:{id:i.id}},[t("i",{class:i.ico,staticStyle:{color:"#409eff"}}),t("div",[e._v(e._s(i.name))])])})),0)]),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary"},on:{click:e.handleclose}},[e._v("确 定")])],1)])},T=[],A={name:"某节点内部详情",nodeList:[{id:"node_detailA",name:"实例A",type:"task",left:"26px",top:"10px",ico:"icon-daqilitiguancex iconfont"},{id:"node_detailB",name:"实例B",type:"task",left:"100px",top:"10px",ico:"icon-VE iconfont"},{id:"node_detailC",name:"实例C",type:"task",left:"170px",top:"10px",ico:"icon-lifangtilitiduomiantifangkuai iconfont"},{id:"node_detailC",name:"实例C",type:"task",left:"270px",top:"10px",ico:"icon-lifangtilitiduomiantifangkuai iconfont"},{id:"node_detailC",name:"实例C",type:"task",left:"380px",top:"10px",ico:"icon-lifangtilitiduomiantifangkuai iconfont"},{id:"node_detailC",name:"实例C",type:"task",left:"450px",top:"10px",ico:"icon-lifangtilitiduomiantifangkuai iconfont"},{id:"node_detailC",name:"实例C",type:"task",left:"580px",top:"10px",ico:"icon-lifangtilitiduomiantifangkuai iconfont"},{id:"node_detailC",name:"实例C",type:"task",left:"640px",top:"10px",ico:"icon-lifangtilitiduomiantifangkuai iconfont"}]},R={props:{currentNode:Object},data(){return{nodeDialogVisible:!1,currentNodeDetail:{}}},mounted(){this.currentNodeDetail=A,this.nodeDialogVisible=!0},methods:{handleclose(){console.log("关闭节点详情"),this.nodeDialogVisible=!1,this.$parent.nodeDetailVisible=!1}}},M=R,z=(i("e90d"),Object(f["a"])(M,P,T,!1,null,null,null)),U=z.exports,J=function(){var e=this,t=e._self._c;return t("el-dialog",{attrs:{title:"数据上传",visible:e.centerDialogVisible,width:"70%",center:""},on:{"update:visible":function(t){e.centerDialogVisible=t}}},[t("el-upload",{staticClass:"upload-box",attrs:{drag:"",accept:".yaml, .json, .js",action:"","file-list":e.uploadFiles,"on-change":e.fileChange,"auto-upload":!1,limit:1,"on-exceed":e.exceedFile}},[t("i",{staticClass:"el-icon-upload"}),t("div",{staticClass:"el-upload__text"},[e._v(" 将文件拖到此处，或 "),t("em",[e._v("点击上传")]),t("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v(" 只能上传 "),t("em",[e._v("yaml / json")]),e._v(" 文件，且最大文件数量不超过 "),t("em",[e._v("1")]),e._v(" 个 ")])])]),t("codemirror",{staticClass:"codemirror",attrs:{value:e.currentNodeData,options:e.options,height:"500px"},model:{value:e.currentNodeData,callback:function(t){e.currentNodeData=t},expression:"currentNodeData"}}),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:e.cancelUpload}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.confirmUpload}},[e._v("确 定")])],1)],1)},G=[],W=(i("a7be"),i("8f94")),Y=(i("eb8f"),i("ced0"),i("f9d4"),{data(){return{uploadFiles:[],centerDialogVisible:!1,currentNodeData:"",options:{tabSize:4,styleActiveLine:!0,matchBrackets:!0,lineNumbers:!0,lineWrapping:!1,line:!0,mode:"text/yaml",theme:"mdn-like"}}},components:{codemirror:W["codemirror"]},watch:{currentNodeData:{handler(e){this.currentNodeData=e},immediate:!0,deep:!0}},mounted(){this.centerDialogVisible=!0},methods:{confirmUpload(){this.$emit("uploadPaintFlow",this.currentNodeData),this.$message.success("渲染成功"),this.centerDialogVisible=!1,this.$parent.uploadDataVisible=!1},cancelUpload(){console.log(this.currentNodeData),this.centerDialogVisible=!1,this.$parent.uploadDataVisible=!1,this.currentNodeData=""},jsonToYaml(e){return $.a.safeDump(e)},yamlToJson(e){return $.a.safeLoad(e)},tirggerFile(){},fileChange(e){if(e){let t=new FileReader;t.readAsText(e.raw),t.onload=()=>{this.$message.success("文件上传成功");var i=t.result,o=e.name.split(".").pop();"yaml"==o&&(i=JSON.stringify(this.yamlToJson(i),null,"\t")),this.currentNodeData=i}}},exceedFile(){this.$message.error("超出文件可上传数量,请先清除文件")}}}),X=Y,q=(i("4bf4"),Object(f["a"])(X,J,G,!1,null,null,null)),H=q.exports,Z=function(){var e=this,t=e._self._c;return t("el-dialog",{staticClass:"image-load-dialog",attrs:{title:"流程图",visible:e.dialogVisible,width:"60%",top:"10vh",center:""},on:{"update:visible":function(t){e.dialogVisible=t},close:e.closeImageLoad}},[t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"load-image-box",class:{"show-grid":e.isShowGrid},attrs:{"element-loading-text":"流程图生成中"}},[e.loading?e._e():t("img",{staticClass:"load-image",attrs:{src:e.imgUrl,alt:""}})]),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:function(t){e.dialogVisible=!1}}},[e._v("确 定")])],1)])},K=[],Q={props:{imgUrl:String,isShowGrid:Boolean},mounted(){this.dialogVisible=!0,setTimeout(()=>{},1e3)},data(){return{dialogVisible:!1,loading:!0}},components:{},methods:{closeImageLoad(){this.dialogVisible=!1,this.$parent.imageLoadVisible=!1,this.isloading=!1}}},ee=Q,te=(i("9403"),Object(f["a"])(ee,Z,K,!1,null,null,null)),ie=te.exports,oe=i("1157"),ne=i.n(oe),ae=function(){var e=this,t=e._self._c;return t("div",[t("div",{staticClass:"ee-node-form"},["line"===e.type?t("div",{staticClass:"ee-node-form-header"},[e._v("连线属性")]):e._e(),"node"===e.type?t("div",{staticClass:"ee-node-form-header"},[e._v("节点属性")]):e._e(),t("div",{staticClass:"ee-node-form-body"},["node"===e.type?t("el-form",{ref:"dataForm",attrs:{model:e.node,"label-width":"80px"}},[t("el-form-item",{attrs:{label:"类型"}},[t("el-input",{attrs:{disabled:!0},model:{value:e.node.type,callback:function(t){e.$set(e.node,"type",t)},expression:"node.type"}})],1),t("el-form-item",{attrs:{label:"left坐标"}},[t("el-input",{attrs:{disabled:""},model:{value:e.node.left,callback:function(t){e.$set(e.node,"left",t)},expression:"node.left"}})],1),t("el-form-item",{attrs:{label:"top坐标"}},[t("el-input",{attrs:{disabled:""},model:{value:e.node.top,callback:function(t){e.$set(e.node,"top",t)},expression:"node.top"}})],1),t("el-form-item",{attrs:{label:"节点名称"}},[t("el-input",{model:{value:e.node.name,callback:function(t){e.$set(e.node,"name",t)},expression:"node.name"}})],1),t("el-form-item",{attrs:{label:"ico图标"}},[t("el-input",{model:{value:e.node.ico,callback:function(t){e.$set(e.node,"ico",t)},expression:"node.ico"}})],1),t("el-form-item",{attrs:{label:"节点状态"}},[t("el-input",{model:{value:e.node.state,callback:function(t){e.$set(e.node,"state",t)},expression:"node.state"}})],1),t("el-form-item",{staticClass:"nodeFormButton"},[t("el-button",{staticClass:"nodeInfo",attrs:{icon:"el-icon-connection"},on:{click:e.showNodeInfo}},[e._v("节点详情")]),t("el-button",{staticClass:"save",attrs:{type:"primary",icon:"el-icon-check"},on:{click:e.save}},[e._v("保存")])],1)],1):e._e(),"line"===e.type?t("el-form",{ref:"dataForm",attrs:{model:e.line,"label-width":"80px"}},[t("el-form-item",{attrs:{label:"条件"}},[t("el-input",{model:{value:e.line.label,callback:function(t){e.$set(e.line,"label",t)},expression:"line.label"}})],1),t("el-form-item",{staticClass:"nodeFormButton"},[t("el-button",{staticClass:"saveLine",attrs:{type:"primary",icon:"el-icon-check"},on:{click:e.saveLine}},[e._v("保存")])],1)],1):e._e()],1),t("div",{staticClass:"el-node-form-tag",on:{click:e.showNodeForm}},[e.isShowNodeForm?t("i",{staticClass:"el-icon-arrow-right"}):t("i",{staticClass:"el-icon-arrow-left"})])])])},se=[],le=i("2ef0"),re=i.n(le),ce={data(){return{visible:!0,type:"node",node:{},line:{label:"",from:"",to:""},data:{},isShowNodeForm:!0,isEmpty:!1,lineValue:"",options:[{value:'["StateMachine", { curviness: 50 }]',label:"StateMachine"},{value:'["Flowchart", { curviness: 50 }]',label:"Flowchart"},{value:'["Bezier", { stub: [0, 0], gap: 1, cornerRadius: 50, alwaysRespectStubs: true }]',label:"Bezier"},{value:'["Straight", { curviness: 50 }]',label:"Straight"}]}},methods:{selectLineStyle(){},nodeInit(e,t){this.type="node",this.data=e,e.nodeList.filter(e=>{e.id===t&&(this.node=Object(le["cloneDeep"])(e))})},lineInit(e){this.type="line",this.isEmpty&&(e.label=""),this.line=e,console.log(e)},saveLine(){console.log(this.line),""===this.line.label?this.isEmpty=!0:this.isEmpty=!1,this.$emit("setLineLabel",this.line.from,this.line.to,this.line.label,this.line.type)},save(){this.data.nodeList.filter(e=>{e.id===this.node.id&&(e.name=this.node.name,e.left=this.node.left,e.top=this.node.top,e.icon=this.node.icon,e.state=this.node.state,this.$emit("repaintEverything"))})},showNodeInfo(){this.node.id?this.$parent.nodeDetailVisible=!0:this.$message.error("请先选择节点")},showNodeForm(){this.$emit("changeNodeForm",this.isShowNodeForm),setTimeout(()=>{this.isShowNodeForm=!this.isShowNodeForm},300)}}},de=ce,ue=(i("59bd"),Object(f["a"])(de,ae,se,!1,null,null,null)),pe=ue.exports,he={name:"流程A",nodeList:[{id:"nodeA",name:"流程A-节点A",type:"task",left:"26px",top:"161px",ico:"icon-daqilitiguancex iconfont",state:"warning"},{id:"nodeB",name:"流程A-节点B",type:"task",left:"340px",top:"161px",ico:"icon-VE iconfont",state:"warning"},{id:"nodeC",name:"流程A-节点C",type:"task",left:"739px",top:"161px",ico:"icon-rongqi iconfont",state:"warning"}],lineList:[{from:"nodeA",to:"nodeB",label:"条件AB",connector:"Bezier"},{from:"nodeB",to:"nodeC"}]},me={name:"流程B",nodeList:[{id:"nodeA",name:"流程B-节点A",type:"task",left:"128px",top:"223px",ico:"el-icon-user-solid",state:"success"},{id:"nodeB",type:"task",name:"流程B-节点B",left:"351px",top:"96px",ico:"el-icon-goods",state:"error"},{id:"nodeC",name:"流程B-节点C",type:"task",left:"354px",top:"351px",ico:"el-icon-present",state:"warning"},{id:"nodeD",name:"流程B-节点D",type:"task",left:"723px",top:"215px",ico:"el-icon-present",state:"running"}],lineList:[{from:"nodeA",to:"nodeB",label:"条件A"},{from:"nodeA",to:"nodeC",label:"条件B"},{from:"nodeB",to:"nodeD"},{from:"nodeC",to:"nodeD"}]},fe={name:"流程C",nodeList:[{id:"nodeA",name:"流程C-节点A",type:"task",left:"400px",top:"15px",ico:"el-icon-user-solid",state:"warning"},{id:"nodeB",name:"流程C-节点B",type:"task",left:"400px",top:"200px",ico:"el-icon-goods",state:"warning"},{id:"nodeC",name:"流程C-节点C",type:"task",left:"400px",top:"378px",ico:"el-icon-present",state:"warning"}],lineList:[{from:"nodeA",to:"nodeB"},{from:"nodeB",to:"nodeC"}]},ge={name:"流程D",nodeList:[{id:"nodeA",name:"流程D-节点A",type:"task",left:"18px",top:"223px",ico:"el-icon-user-solid",state:"success"},{id:"nodeB",type:"task",name:"流程D-节点B",left:"351px",top:"96px",ico:"el-icon-goods",state:"error"},{id:"nodeC",name:"流程D-节点C",type:"task",left:"354px",top:"351px",ico:"el-icon-present",state:"warning"},{id:"nodeD",name:"流程D-节点D",type:"task",left:"723px",top:"215px",ico:"el-icon-present",state:"running"}],lineList:[{from:"nodeA",to:"nodeB",label:"直线,自定义线样式,固定锚点",connector:"Straight",anchors:["Top","Bottom"],paintStyle:{strokeWidth:2,stroke:"#1879FF"}},{from:"nodeA",to:"nodeC",label:"贝塞尔曲线,固定锚点",connector:"Bezier",anchors:["Bottom","Left"]},{from:"nodeB",to:"nodeD",label:"默认连线样式,动态锚点"},{from:"nodeC",to:"nodeD",label:"默认连线样式,动态锚点"}]},be={data(){return{jsPlumb:null,flowVisible:!0,flowInfoVisible:!1,loadEasyFlowFinish:!1,data:{},activeElement:{type:void 0,nodeId:void 0,sourceId:void 0,targetId:void 0},jsplumbSetting:{Anchors:["Top","TopCenter","TopRight","TopLeft","Right","RightMiddle","Bottom","BottomCenter","BottomRight","BottomLeft","Left","LeftMiddle"],Container:"eeContainer",Connector:["Flowchart",{stub:30,gap:1,alwaysRespectStubs:!1,midpoint:.5,cornerRadius:10}],ConnectionsDetachable:!0,DeleteEndpointsOnDetach:!1,Endpoint:["Blank",{Overlays:""}],EndpointStyle:{fill:"#1879ffa1",outlineWidth:1},LogEnabled:!0,PaintStyle:{stroke:"#000000",strokeWidth:1,outlineStroke:"transparent",outlineWidth:10},Overlays:[["Arrow",{width:10,length:8,location:1,direction:1,foldback:.623}],["Label",{label:"",location:2.2,cssClass:"aLabel"}]],RenderMode:"svg",DragOptions:{cursor:"pointer",zIndex:2e3},HoverPaintStyle:{stroke:"#1879ff",strokeWidth:3,cursor:"pointer"},Scope:"jsPlumb_DefaultScope"},jsplumbConnectOptions:{isSource:!0,isTarget:!0,anchor:"Continuous",labelStyle:{cssClass:"flowLabel"},emptyLabelStyle:{cssClass:"emptyFlowLabel"}},jsplumbSourceOptions:{filter:".flow-node-drag",filterExclude:!1,anchor:"Continuous",allowLoopback:!1,maxConnections:-1,onMaxConnections:function(e){console.log("超过了最大值连线: "+e.maxConnections)}},jsplumbSourceOptions2:{filter:".flow-node-drag",filterExclude:!1,allowLoopback:!1,connector:["Flowchart",{curviness:50}],connectorStyle:{stroke:"red",strokeWidth:1,outlineStroke:"transparent",outlineWidth:10},connectorHoverStyle:{stroke:"red",strokeWidth:2}},jsplumbTargetOptions:{filter:".flow-node-drag",filterExclude:!1,anchor:"Continuous",allowLoopback:!1,dropOptions:{hoverClass:"ee-drop-hover"}},isNodeFormActive:!1,currentData:{},scaleValue:1,currentNode:{},nodeDetailVisible:!1,uploadDataVisible:!1,imageLoadVisible:!1,imgUrl:"../assets/images/2.5D-2.jpg",isShowGrid:!0}},components:{uploadData:H,imageLoad:ie,flowNode:b,nodeMenu:S,FlowInfo:O,FlowNodeForm:pe,nodeDetail:U},directives:{flowDrag:{bind(e,t,i,o){console.log("flowDrag",i,o),t&&(e.onmousedown=t=>{if(2==t.button)return void console.log("右键需求待完成");let i=t.clientX,o=t.clientY;ne()(".ee-node-active").removeClass("ee-node-active"),e.style.cursor="move",document.onmousemove=function(t){t.preventDefault();const n=t.clientX-i;e.scrollLeft+=-n;const a=t.clientY-o;e.scrollTop+=-a,i=t.clientX,o=t.clientY},document.onmouseup=function(){e.style.cursor="auto",document.onmousemove=null,document.onmouseup=null}})}}},mounted(){this.jsPlumb=r["jsPlumb"].getInstance(),this.$nextTick(()=>{this.currentData=he,this.dataReload(this.currentData)}),this.$notify({title:"欢迎使用 Easy Editor",dangerouslyUseHTMLString:!0,message:"<p> 当前版本：1.0.0 <br /> Powered by Jason chen<br /> Gitee:<a target='blank' href='https://gitee.com/save_money/Easy-Editor'>  Easy Editor  </a> </p>",showClose:!0,iconClass:"icon-workflow-copy iconfont",position:"bottom-right",offset:100,customClass:"notify-tip"})},methods:{saveAsImage(){var e=document.getElementById("eeContainer");d.a.toPng(e).then(e=>{this.imgUrl=e,this.$refs.imageLoad.loading=!1}).catch((function(e){console.error("oops, something went wrong!",e)})),this.imageLoadVisible=!0},showNodeDetail(e){this.nodeDetailVisible=!0,this.currentNode=Object.create(e)},startScale(){this.$refs.eeContainer.style.transform=`scale(${this.scaleValue})`,this.jsPlumb.setZoom(""+this.scaleValue);var e=ne()("#center-container").width(),t=ne()("#center-container").height();this.scaleValue<1?(ne()("#eeContainer").width(e/this.scaleValue),ne()("#eeContainer").height(t/this.scaleValue)):(ne()("#eeContainer").width(e*this.scaleValue),ne()("#eeContainer").height(t*this.scaleValue))},getUUID(){return Math.random().toString(36).substr(3,10)},jsPlumbInit(){this.jsPlumb.ready(()=>{this.jsPlumb.importDefaults(this.jsplumbSetting),this.jsPlumb.setSuspendDrawing(!1,!0),this.loadEasyFlow(),this.jsPlumb.bind("click",(e,t)=>{console.log(t),this.activeElement.type="line",this.activeElement.sourceId=e.sourceId,this.activeElement.targetId=e.targetId,this.$refs.nodeForm.lineInit({from:e.sourceId,to:e.targetId,label:e.getLabel(),type:e.connector.type})}),this.jsPlumb.bind("dblclick",e=>{this.$confirm("确定删除所点击的线吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{this.jsPlumb.deleteConnection(e),this.$message.success("删除成功")}).catch(()=>{this.$message.info("取消删除")})}),this.jsPlumb.bind("connection",e=>{let t=e.source.id,i=e.target.id;this.loadEasyFlowFinish&&this.data.lineList.push({from:t,to:i})}),this.jsPlumb.bind("connectionDetached",e=>{this.deleteLine(e.sourceId,e.targetId)}),this.jsPlumb.bind("connectionMoved",e=>{this.changeLine(e.originalSourceId,e.originalTargetId)}),this.jsPlumb.bind("contextmenu",e=>{console.log("contextmenu",e)}),this.jsPlumb.bind("beforeDrop",e=>{let t=e.sourceId,i=e.targetId;return t===i?(this.$message.error("节点不支持连接自己"),!1):this.hasLine(t,i)?(this.$message.error("该关系已存在,不允许重复创建"),!1):(this.$message.success("连接成功"),!0)}),this.jsPlumb.bind("beforeDetach",e=>{console.log("beforeDetach",e)}),this.jsPlumb.setContainer(this.$refs.eeContainer)})},loadEasyFlow(){for(var e=0;e<this.data.nodeList.length;e++){let t=this.data.nodeList[e],i=this;this.jsPlumb.makeSource(t.id,this.jsplumbSourceOptions),this.jsPlumb.makeTarget(t.id,this.jsplumbTargetOptions),this.jsPlumb.draggable(t.id,{containment:"parent",stop:e=>{i.currentData=i.data,console.log("停止拖拽",e)}}),this.jsPlumb.bind("click",(function(e,t){console.log(e,t)}))}for(var t=0;t<this.data.lineList.length;t++){let e=this.data.lineList[t];var i={source:e.from,target:e.to,label:e.label?e.label:"",connector:e.connector?e.connector:"",anchors:e.anchors?e.anchors:void 0,paintStyle:e.paintStyle?e.paintStyle:void 0};this.jsPlumb.connect(i,this.jsplumbConnectOptions)}this.$nextTick((function(){this.loadEasyFlowFinish=!0}))},setLineLabel(e,t,i,o){var n=this.jsPlumb.getConnections({source:e,target:t})[0];if(i&&""!==i&&null!=i)n.addClass("flowLabel"),n.removeClass("emptyFlowLabel"),console.log(o),n.setLabel({label:i});else{if(!n.getLabel())return;n.removeClass("flowLabel"),n.addClass("emptyFlowLabel")}},deleteElement(){"node"===this.activeElement.type?this.deleteNode(this.activeElement.nodeId):"line"===this.activeElement.type&&this.$confirm("确定删除所点击的线吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{var e=this.jsPlumb.getConnections({source:this.activeElement.sourceId,target:this.activeElement.targetId})[0];this.jsPlumb.deleteConnection(e)}).catch(()=>{})},deleteLine(e,t){this.data.lineList=this.data.lineList.filter((function(i){return i.from!=e||i.to!=t}))},changeLine(e,t){this.deleteLine(e,t)},changeNodeSite(e){for(var t=0;t<this.data.nodeList.length;t++){let i=this.data.nodeList[t];i.id===e.nodeId&&(i.left=e.left,i.top=e.top)}},changeNodeForm(){this.isNodeFormActive=!this.isNodeFormActive},addNode(e,t,i){console.log(i);var o=e.originalEvent.clientX;let n=e.originalEvent.clientY,a=this.$refs.eeContainer;var s=a.getBoundingClientRect(),l=o,r=n;if(l<s.x||l>s.width+s.x||r<s.y||s.y>s.y+s.height)this.$message.error("请把节点拖入到画布中");else{l=l-s.x+a.scrollLeft,r=r-s.y+a.scrollTop,l-=85,r-=16;var c=this.getUUID(),d=t.name,u=d,p=1;while(p<1e4){for(var h=!1,m=0;m<this.data.nodeList.length;m++){let e=this.data.nodeList[m];e.name===u&&(u=d+p,h=!0)}if(!h)break;p++}var f={id:c,name:u,type:t.type,left:l+"px",top:r+"px",ico:t.ico,state:t.state};this.data.nodeList.push(f),this.$nextTick((function(){this.jsPlumb.makeSource(c,this.jsplumbSourceOptions),this.jsPlumb.makeTarget(c,this.jsplumbTargetOptions),this.jsPlumb.draggable(c)}))}},deleteNode(e){return this.$confirm("确定要删除节点"+e+"?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",closeOnClickModal:!1}).then(()=>{this.data.nodeList=this.data.nodeList.filter((function(t){return t.id!==e})),this.$nextTick((function(){this.jsPlumb.removeAllEndpoints(e)}))}).catch(()=>{}),!0},clickNode(e){this.activeElement.type="node",this.activeElement.nodeId=e,this.$refs.nodeForm.nodeInit(this.data,e)},hasLine(e,t){for(var i=0;i<this.data.lineList.length;i++){var o=this.data.lineList[i];if(o.from===e&&o.to===t)return!0}return!1},hashOppositeLine(e,t){return this.hasLine(t,e)},nodeRightMenu(e,t){this.menu.show=!0,this.menu.curNodeId=e,this.menu.left=t.x+"px",this.menu.top=t.y+"px"},repaintEverything(){console.log("重绘"),this.jsPlumb.repaint()},dataInfo(){this.flowInfoVisible=!0,this.$nextTick((function(){this.$refs.flowInfo.init()}))},dataReload(e){this.flowVisible=!1,this.data.nodeList=[],this.data.lineList=[],this.$nextTick(()=>{e=re.a.cloneDeep(e),this.flowVisible=!0,this.data=e,this.currentData=e,this.$nextTick(()=>{this.jsPlumb=r["jsPlumb"].getInstance(),this.$nextTick(()=>{this.jsPlumbInit()})})})},dataReloadA(){this.currentData=he,this.dataReload(he)},dataReloadB(){this.currentData=me,this.dataReload(me)},dataReloadC(){this.currentData=fe,console.log(fe),this.dataReload(fe)},dataReloadD(){this.currentData=ge,this.dataReload(ge)},uploadPaintFlow(e){try{console.log(JSON.parse(e)),this.currentData=JSON.parse(e),this.dataReload(this.currentData)}catch(t){console.log("出错啦",t)}},downloadData(){this.$confirm("确定要下载该流程数据吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",closeOnClickModal:!1}).then(()=>{var e="data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(this.data,null,"\t")),t=document.createElement("a");t.setAttribute("href",e),t.setAttribute("download","data.json"),t.click(),t.remove(),this.$message.success("正在下载中,请稍后...")}).catch(()=>{})}}},ve=be,ye=(i("a977"),Object(f["a"])(ve,s,l,!1,null,null,null)),we=ye.exports,xe={name:"App",components:{FlowEditor:we}},Ce=xe,ke=Object(f["a"])(Ce,n,a,!1,null,null,null),De=ke.exports,Le=i("5c96"),Se=i.n(Le);i("0fae"),i("df6a"),i("b29b");o["default"].config.productionTip=!1,o["default"].use(Se.a,{size:"small"}),new o["default"]({render:e=>e(De)}).$mount("#app")},"59bd":function(e,t,i){"use strict";i("98e5")},"5a73":function(e,t,i){},9403:function(e,t,i){"use strict";i("e519")},"98e5":function(e,t,i){},a977:function(e,t,i){"use strict";i("29a0")},b29b:function(e,t,i){},b660:function(e,t,i){"use strict";i("2a22")},df6a:function(e,t,i){},e519:function(e,t,i){},e90d:function(e,t,i){"use strict";i("5a73")}});
//# sourceMappingURL=app.6eecaadf.js.map